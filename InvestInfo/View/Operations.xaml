<UserControl x:Class="InvestInfo.View.Operations"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:vm="clr-namespace:InvestInfo.ViewModel"
             mc:Ignorable="d" 
             d:DesignHeight="600"
             d:DesignWidth="630"
             Style="{StaticResource Page_Style}">

    <Grid Margin="20">

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- 🔹 Блок добавления операции -->
        <Border Grid.Row="0"
            Background="#333333"
            Padding="10"
            CornerRadius="8"
            Margin="0,0,0,15">

            <StackPanel Orientation="Horizontal">

                <TextBox Style="{StaticResource OperationTextBoxStyle}"
             Width="200"
             Text="{Binding Title, UpdateSourceTrigger=PropertyChanged}" />

                <TextBox Style="{StaticResource OperationTextBoxStyle}"
             Width="120"
             Text="{Binding Amount, UpdateSourceTrigger=PropertyChanged}" />

                <Button Content="Добавить"
            Style="{StaticResource AddButtonStyle}"
            Command="{Binding AddOperationCommand}" />

            </StackPanel>
            
        </Border>


        <!-- 🔹 Список операций -->
        <ItemsControl Grid.Row="1"
                      ItemsSource="{Binding Operations}">
            <ItemsControl.ItemTemplate>
                <DataTemplate>

                    <Border Style="{StaticResource OperationCardStyle}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="120"/>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Text="{Binding Title}"
                               Foreground="White"
                               VerticalAlignment="Center"/>

                            <TextBlock Grid.Column="1"
                               Text="{Binding Amount, StringFormat={}{0:N2}}"
                               Foreground="White"
                               VerticalAlignment="Center"/>

                            <TextBlock Grid.Column="2"
                               Text="{Binding Date, StringFormat={}{0:dd.MM.yyyy}}"
                               Foreground="White"
                               VerticalAlignment="Center"/>

                            <Button Grid.Column="3"
                            Content="✖"
                            Style="{StaticResource DeleteButtonStyle}"
                            Command="{Binding DataContext.DeleteOperationCommand,
                                      RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                            CommandParameter="{Binding}" />

                        </Grid>
                    </Border>

                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>

    </Grid>

</UserControl>
